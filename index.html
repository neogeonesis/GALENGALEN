<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Web Arrastrable Corregido</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #ffffff; 
            height: 100vh;
            overflow: hidden; 
            font-family: 'Courier New', Courier, monospace;
        }

        .draggable {
            position: absolute; 
            cursor: grab;
            background: white;
            padding: 10px;
            border: none; 
            box-shadow: none; 
            user-select: none;
            width: fit-content;
        }

        .draggable:active {
            cursor: grabbing;
            background-color: #f0f0f0; 
        }

        /* --- ESTILOS DE IMAGEN --- */

        .image-container {
            /* Contenedor principal de la imagen: define el tamaño fijo */
            width: 200px;
            height: 200px;
            position: relative; 
            overflow: hidden; 
        }
        
        .grayscale-image {
            /* La capa inferior: imagen en escala de grises */
            filter: grayscale(100%);
        }

        .color-reveal {
            /* El visor: capa superior a color */
            position: absolute;
            top: 0;
            left: 0;
            width: 200px;
            height: 200px;
            /* Máscara circular: el "foco" */
            clip-path: circle(0px at 50% 50%); /* Comienza oculto */
        }

        /* La imagen en sí dentro del visor */
        .color-reveal img {
            filter: grayscale(0%);
            position: absolute;
            top: 0;
            left: 0;
            margin: 0; 
        }
        
        /* Estilos generales para todas las imágenes */
        img {
            pointer-events: none; /* Crucial para el arrastre */
            display: block;
            max-width: 200px; 
            height: auto;
        }
    </style>
</head>
<body>

    <div class="draggable" style="top: 10%; left: 10%;">
        <div class="image-container">
            <img class="grayscale-image" src="imagenes/grande1.jpg" alt="Imagen Arrastrable">
            
            <div class="color-reveal">
                <img src="imagenes/grande1.jpg" alt="Imagen a Color">
            </div>
        </div>
        <p>¡Arrastra y Revela!</p>
    </div>

    <div class="draggable" style="top: 40%; left: 50%;">
        <h3>Hola Mundo</h3>
        <p>Soy una nota flotante.</p>
    </div>

    <div class="draggable" style="top: 20%; left: 70%;">
        <div class="image-container">
            <img class="grayscale-image" src="imagenes/grande1.jpg" alt="Imagen Arrastrable">
            <div class="color-reveal">
                <img src="imagenes/grande1.jpg" alt="Imagen a Color">
            </div>
        </div>
    </div>

    <script>
        // --- CÓDIGO DE ARRASTRE (NO CAMBIÓ) ---
        const draggables = document.querySelectorAll('.draggable');
        let currentElement = null;
        let startX = 0, startY = 0, initialLeft = 0, initialTop = 0;
        let zIndexCounter = 1;

        draggables.forEach(element => {
            element.addEventListener('mousedown', (e) => {
                currentElement = element;
                startX = e.clientX;
                startY = e.clientY;
                
                const rect = currentElement.getBoundingClientRect();
                initialLeft = rect.left;
                initialTop = rect.top;

                zIndexCounter++;
                currentElement.style.zIndex = zIndexCounter;
            });
        });

        document.addEventListener('mousemove', (e) => {
            if (!currentElement) return;
            e.preventDefault(); 

            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;

            currentElement.style.left = `${initialLeft + deltaX}px`;
            currentElement.style.top = `${initialTop + deltaY}px`;
        });

        document.addEventListener('mouseup', () => {
            currentElement = null;
        });

        // --- CÓDIGO DE REVELADO (AÑADIDO Y MEJORADO) ---
        
        const imageContainers = document.querySelectorAll('.image-container');
        const revealSize = '50px'; // Tamaño del círculo de revelado

        imageContainers.forEach(container => {
            const reveal = container.querySelector('.color-reveal');
            
            container.addEventListener('mousemove', (e) => {
                // Posición relativa del ratón dentro del contenedor
                const rect = container.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Aplica el clip-path al visor
                reveal.style.clipPath = `circle(${revealSize} at ${x}px ${y}px)`;
            });

            container.addEventListener('mouseleave', () => {
                // Oculta el foco cuando el ratón sale
                reveal.style.clipPath = 'circle(0px at 50% 50%)';
            });
        });
    </script>

</body>
</html>
